(()=>{var e={};e.id=1695,e.ids=[1695],e.modules={72934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},54580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},45869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},27790:e=>{"use strict";e.exports=require("assert")},84770:e=>{"use strict";e.exports=require("crypto")},17702:e=>{"use strict";e.exports=require("events")},92048:e=>{"use strict";e.exports=require("fs")},32615:e=>{"use strict";e.exports=require("http")},32694:e=>{"use strict";e.exports=require("http2")},35240:e=>{"use strict";e.exports=require("https")},19801:e=>{"use strict";e.exports=require("os")},55315:e=>{"use strict";e.exports=require("path")},76162:e=>{"use strict";e.exports=require("stream")},74175:e=>{"use strict";e.exports=require("tty")},17360:e=>{"use strict";e.exports=require("url")},21764:e=>{"use strict";e.exports=require("util")},71568:e=>{"use strict";e.exports=require("zlib")},37494:(e,r,t)=>{"use strict";t.r(r),t.d(r,{GlobalError:()=>n.a,__next_app__:()=>p,originalPathname:()=>u,pages:()=>c,routeModule:()=>m,tree:()=>o}),t(30234),t(4558),t(22834),t(77972),t(10704),t(7629),t(11930),t(12523);var s=t(23191),a=t(88716),i=t(37922),n=t.n(i),l=t(95231),d={};for(let e in l)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(d[e]=()=>l[e]);t.d(r,d);let o=["",{children:["dashboard",{children:["messages",{children:["[id]",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(t.bind(t,30234)),"C:\\Users\\mutir\\OneDrive\\Desktop\\mari\\athena-platform\\client\\src\\app\\dashboard\\messages\\[id]\\page.tsx"]}]},{}]},{layout:[()=>Promise.resolve().then(t.bind(t,4558)),"C:\\Users\\mutir\\OneDrive\\Desktop\\mari\\athena-platform\\client\\src\\app\\dashboard\\messages\\layout.tsx"]}]},{layout:[()=>Promise.resolve().then(t.bind(t,22834)),"C:\\Users\\mutir\\OneDrive\\Desktop\\mari\\athena-platform\\client\\src\\app\\dashboard\\layout.tsx"],loading:[()=>Promise.resolve().then(t.bind(t,77972)),"C:\\Users\\mutir\\OneDrive\\Desktop\\mari\\athena-platform\\client\\src\\app\\dashboard\\loading.tsx"]}]},{layout:[()=>Promise.resolve().then(t.bind(t,10704)),"C:\\Users\\mutir\\OneDrive\\Desktop\\mari\\athena-platform\\client\\src\\app\\layout.tsx"],error:[()=>Promise.resolve().then(t.bind(t,7629)),"C:\\Users\\mutir\\OneDrive\\Desktop\\mari\\athena-platform\\client\\src\\app\\error.tsx"],loading:[()=>Promise.resolve().then(t.bind(t,11930)),"C:\\Users\\mutir\\OneDrive\\Desktop\\mari\\athena-platform\\client\\src\\app\\loading.tsx"],"not-found":[()=>Promise.resolve().then(t.bind(t,12523)),"C:\\Users\\mutir\\OneDrive\\Desktop\\mari\\athena-platform\\client\\src\\app\\not-found.tsx"]}],c=["C:\\Users\\mutir\\OneDrive\\Desktop\\mari\\athena-platform\\client\\src\\app\\dashboard\\messages\\[id]\\page.tsx"],u="/dashboard/messages/[id]/page",p={require:t,loadChunk:()=>Promise.resolve()},m=new s.AppPageRouteModule({definition:{kind:a.x.APP_PAGE,page:"/dashboard/messages/[id]/page",pathname:"/dashboard/messages/[id]",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:o}})},47467:(e,r,t)=>{Promise.resolve().then(t.bind(t,74664))},74664:(e,r,t)=>{"use strict";t.r(r),t.d(r,{default:()=>h});var s=t(10326),a=t(17577),i=t(90422),n=t(96040),l=t(32027),d=t(61824),o=t(71709),c=t(94019),u=t(56418),p=t(91664),m=t(41190);function x({conversationId:e}){let{data:r,isLoading:t}=(0,i.y_)(e),x=(0,i.$3)(),{user:h}=(0,n.tN)(),{messages:g,setMessages:f,addMessage:b,setActiveConversation:y,markConversationAsRead:v}=(0,l.a)(),[j,k]=(0,a.useState)(""),[N,w]=(0,a.useState)([]),D=(0,a.useRef)(null),q=(0,a.useRef)(null),P=g[e]||[],C=async r=>{if(r.preventDefault(),j.trim()||0!==N.length)try{let r=await x.mutateAsync({receiverId:e,content:j});k(""),w([]),r&&b(e,{id:r.data?.id||crypto.randomUUID(),senderId:h?.id||"",content:j,createdAt:new Date().toISOString(),type:"text",status:"sent"})}catch(e){console.error("Failed to send message",e)}},_=e=>{e&&w(r=>[...r,...Array.from(e)])},U=e=>{w(r=>r.filter((r,t)=>t!==e))};return t&&0===P.length?s.jsx("div",{className:"flex-1 flex items-center justify-center h-full",children:"Loading messages..."}):(0,s.jsxs)("div",{className:"flex flex-col h-full bg-gray-50 dark:bg-gray-950",children:[(0,s.jsxs)("div",{className:"flex-1 overflow-y-auto p-4 space-y-4",children:[P.map(e=>{let r=e.senderId===h?.id;return s.jsx("div",{className:`flex ${r?"justify-end":"justify-start"}`,children:(0,s.jsxs)("div",{className:`max-w-[70%] px-4 py-2 rounded-lg shadow-sm ${r?"bg-blue-600 text-white rounded-br-none":"bg-white dark:bg-gray-900 text-gray-900 dark:text-gray-100 rounded-bl-none"}`,children:[s.jsx("p",{className:"whitespace-pre-wrap break-words text-sm",children:e.content}),(0,s.jsxs)("div",{className:`text-xs mt-1 flex items-center gap-2 ${r?"text-blue-100":"text-gray-400"}`,children:[s.jsx("span",{children:(0,d.WU)(new Date(e.createdAt),"h:mm a")}),r&&e.status&&s.jsx("span",{className:"uppercase tracking-wide",children:"sending"===e.status?"Sending":e.status})]})]})},e.id)}),s.jsx("div",{ref:D})]}),(0,s.jsxs)("div",{className:"bg-white dark:bg-gray-900 border-t border-gray-200 dark:border-gray-800 p-4",children:[N.length>0&&s.jsx("div",{className:"mb-3 grid grid-cols-2 md:grid-cols-4 gap-2",children:N.map((e,r)=>(0,s.jsxs)("div",{className:"relative border border-gray-200 dark:border-gray-700 rounded-lg p-2 text-xs text-gray-600 dark:text-gray-300",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[s.jsx(o.Z,{className:"w-4 h-4 text-gray-400"}),s.jsx("span",{className:"truncate",children:e.name})]}),s.jsx("button",{type:"button",onClick:()=>U(r),className:"absolute -top-2 -right-2 bg-gray-900 text-white rounded-full w-5 h-5 flex items-center justify-center","aria-label":"Remove attachment",children:s.jsx(c.Z,{className:"w-3 h-3"})})]},`${e.name}-${r}`))}),(0,s.jsxs)("form",{onSubmit:C,className:"flex gap-2 items-center",children:[s.jsx("input",{ref:q,type:"file",multiple:!0,className:"hidden",onChange:e=>_(e.target.files)}),s.jsx(p.z,{type:"button",variant:"outline",size:"icon","aria-label":"Attach files",onClick:()=>q.current?.click(),children:s.jsx(u.Z,{className:"w-4 h-4"})}),s.jsx("div",{className:"flex-1",children:s.jsx(m.I,{value:j,onChange:e=>k(e.target.value),placeholder:"Type a message...","aria-label":"Message"})}),s.jsx(p.z,{type:"submit",disabled:!j.trim()&&0===N.length||x.isPending,children:"Send"})]})]})]})}function h({params:e}){return s.jsx(x,{conversationId:e.id})}},41190:(e,r,t)=>{"use strict";t.d(r,{I:()=>n});var s=t(10326),a=t(17577),i=t(51223);let n=a.forwardRef(({className:e,type:r,error:t,label:a,icon:n,...l},d)=>(0,s.jsxs)("div",{className:"w-full",children:[a&&s.jsx("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:a}),(0,s.jsxs)("div",{className:"relative",children:[n&&s.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:n}),s.jsx("input",{type:r,className:(0,i.cn)("flex h-10 w-full rounded-lg border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 px-3 py-2 text-sm text-gray-900 dark:text-white placeholder:text-gray-400 dark:placeholder:text-gray-500 focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-transparent disabled:cursor-not-allowed disabled:opacity-50",n&&"pl-10",t&&"border-red-500 focus:ring-red-500",e),ref:d,...l})]}),t&&s.jsx("p",{className:"mt-1 text-sm text-red-600",children:t})]}));n.displayName="Input"},30234:(e,r,t)=>{"use strict";t.r(r),t.d(r,{default:()=>s});let s=(0,t(68570).createProxy)(String.raw`C:\Users\mutir\OneDrive\Desktop\mari\athena-platform\client\src\app\dashboard\messages\[id]\page.tsx#default`)}};var r=require("../../../../webpack-runtime.js");r.C(e);var t=e=>r(r.s=e),s=r.X(0,[2145,108,8759,7344,3686,3442,9835,422,5877,1045],()=>t(37494));module.exports=s})();